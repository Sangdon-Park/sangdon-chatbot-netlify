# 박상돈 챗봇 개발 가이드라인 및 현황

## 🚨 핵심 원칙 (절대 준수)

### ❌ 하드코딩 절대 금지
- **결정론적 응답 (deterministic replies) 사용 금지**
- **패턴 매칭으로 미리 정해진 답변 반환 금지**
- **AI가 자연스럽게 이해하고 응답하도록 프롬프트 엔지니어링으로 해결**

### ✅ 올바른 접근 방법
- **프롬프트 개선을 통한 AI 성능 향상**
- **명확한 지침과 예시 제공**
- **AI가 문맥을 이해하도록 충분한 정보 제공**

## 📅 2025년 8월 27일 현재 상황

### 1. 시스템 구조
```
/mnt/e/GitHub/Sangdon-Park.github.io/
├── sangdon-chatbot-netlify/         # 챗봇 백엔드
│   └── netlify/functions/
│       └── chat-ai-driven.js       # 메인 챗봇 로직
└── Sangdon-Park.github.io/          # 홈페이지
    ├── ko.html                      # 한국어 페이지
    └── cv-ko.tex                    # 이력서 (최신 정보)
```

### 2. 기술 스택
- **AI 모델**: Google Gemini 2.5 Flash
- **임베딩**: gemini-embedding-001 (768 차원)
- **배포**: Netlify Functions (Serverless)
- **데이터베이스**: Supabase PostgreSQL

### 3. 핵심 데이터
- **세미나**: 총 13회 (2023-2025)
- **논문**: 총 25편 (국제저널)
- **강연료**: 시간당 50만원 (1-2시간, 맞춤형)
- **연락처**: chaos@sayberrygames.com

## 🔧 최근 수정 내역 (2025년 8월 27일)

### 문제점들
1. **세미나 가격 질문** → "1회당 얼마죠?" → 제대로 답변 안 함
2. **세미나 문의** → "AI 세미나에 대해 궁금합니다" → 과거 세미나 목록 나열 (쓸모없음)
3. **세미나 신청** → "신청하고 싶은데" → "어떤 세미나를 신청하실건가요?" (멍청한 질문)
4. **논문 검색** → 세미나까지 섞여서 나옴
5. **대화 문맥** → 이전 대화 기록 무시
6. **응답 길이** → maxOutputTokens 500으로 잘림

### 해결 방법 (잘못된 시도 - 하드코딩)
```javascript
// ❌ 잘못된 방법 - 하드코딩
if (pricingQuery) {
  deterministicReply = `AI 세미나 강연료는...`;
  return deterministicReply;
}
```

### 해결 방법 (올바른 방법 - 프롬프트 개선)
```javascript
// ✅ 올바른 방법 - AI 프롬프트 개선
const finalPrompt = `
중요한 정보:
- 총 13회 세미나 진행
- 강연료: 시간당 50만원
- 신청: chaos@sayberrygames.com

사용자 의도별 답변 방법:
1. "AI 세미나에 대해 궁금" → 반드시 포함: 내용, 비용, 신청방법
   금지: 과거 세미나 목록 나열
2. "세미나 신청" → 반드시: 이메일 안내
   금지: "어떤 세미나 신청?" 묻기
3. "얼마?" → 반드시: "시간당 50만원, 1-2시간"
`;
```

## 📊 개선 결과

### 성능 개선
- 응답 시간: 8-10초 → 3-4초 (67% 개선)
- maxOutputTokens: 500 → 2000 (응답 잘림 해결)
- 검색 결과: 5-8개 → 25개 (논문), 15개 (세미나)

### 기능 개선
- ✅ 논문/세미나 분리 검색
- ✅ 대화 문맥 유지
- ✅ 세미나 가격 정확 응답
- ✅ 신청 문의 적절 처리
- ✅ 일반 문의 시 유용한 정보 제공

## 🚨 중요 교훈

### 절대 하면 안 되는 것
1. **하드코딩된 응답** - AI의 유연성 상실
2. **패턴 매칭 남용** - 예상 못한 질문 처리 불가
3. **결정론적 분기** - 자연스러운 대화 흐름 방해

### 반드시 해야 하는 것
1. **프롬프트 엔지니어링** - AI가 이해하도록 명확한 지침
2. **컨텍스트 제공** - 충분한 배경 정보
3. **예시 제공** - 원하는 응답 형태 시연

## 💡 프롬프트 엔지니어링 핵심 기법

### 1. 정보 구조화
```
중요한 정보: [핵심 팩트 나열]
사용자 의도별 답변: [시나리오별 가이드]
```

### 2. 명확한 지시어
- "반드시 포함" - 필수 요소
- "금지" - 하지 말아야 할 것
- "정확히" - 정확한 표현

### 3. 부정 지시 활용
- "과거 세미나 목록 나열하지 말 것"
- "어떤 세미나 신청할지 묻지 말 것"

## 📝 테스트 파일들
- `comprehensive-qa-test.js` - 종합 QA 테스트
- `conversation-context-test.js` - 대화 연속성 테스트
- `paper-seminar-test.js` - 논문/세미나 분리 테스트
- `test-ai-natural.js` - AI 자연 응답 테스트

## 🎯 현재 상태 (2025-08-27)

### 작동 중인 기능
- 세미나 개수: "13회" 정확 응답
- 논문 개수: "25편" 정확 응답  
- 세미나 가격: "시간당 50만원, 1-2시간, 맞춤형"
- 신청 문의: "chaos@sayberrygames.com으로 연락"
- 논문/세미나 분리 검색

### 핵심 성공 요인
**하드코딩 없이 프롬프트 엔지니어링으로 모든 문제 해결**

## 🔴 절대 잊지 말 것

### 사용자 피드백 (2025-08-27)
> "아니 그러면 안된다니까?????? 미치겠네 ;; AI가 잘 하도록 프롬프트를 개선해야 해 ;;"

**교훈**: 하드코딩은 임시방편일 뿐, 근본적 해결책은 AI가 스스로 이해하고 답변하도록 만드는 것

---
*최종 업데이트: 2025년 8월 27일 오후 12:41*
*작성: Claude (with 사용자 강력한 피드백)*