# Chatbot Critical Fixes - Aug 27, 2025

## Issues Identified from Test Results

### 1. Contact/Email Questions (43% failure rate)
- Questions like "연락처?", "신청은 어떻게?", "어디로 연락?" were not returning email
- Root cause: Being classified as CHAT without proper response

### 2. Confirmation Questions 
- Questions with "맞아?", "맞죠?", "맞지?" were not confirming with "네"
- Responses lacked acknowledgment phrases

### 3. Compound Questions (20% failure)
- Questions like "세미나 얼마고 몇 번?" missing price (50만원)
- Not answering all parts of multi-part questions

## Fixes Applied

### 1. Enhanced Search Detection
- Added more keywords to trigger SEARCH: '연락처', '이메일', 'contact', '신청', '어디로', '맞아', '맞죠'
- Added examples in prompt: "연락처?" → ACTION: SEARCH, QUERY: 연락처 이메일

### 2. Improved Prompt Templates
```
▶ 확인 질문 ("맞아?" "맞지?" "맞죠?" 포함시):
- "세미나 13회 맞아?" → "네, 총 13회 진행했습니다."
- "논문 25편 맞죠?" → "네, 국제저널 25편입니다."

▶ 복합 질문 - 반드시 각 부분 모두 답변:
"세미나 얼마고 몇 번?" → "시간당 50만원이고, 총 13회 진행했습니다."
"비용이랑 연락처?" → "시간당 50만원이며, chaos@sayberrygames.com으로 연락주세요."
```

### 3. Context-Aware Short Questions
- Detects questions under 20 characters
- Provides context hints for proper responses
- Handles "얼마?", "연락처?", "How much?" etc.

### 4. Critical Rules Added
```
【최우선 규칙 - 무조건 따를 것!】
1. 복합 질문은 반드시 모든 부분에 답변!
2. "맞아?" "맞지?" 확인 질문은 반드시 "네"로 시작!
3. "연락처?" "어디로?" → 반드시 이메일 주소!
4. "가격?" "얼마?" → 반드시 "50만원" 포함!
```

### 5. Default CHAT Response
- If ACTION is CHAT but no initialMessage, provides default greeting
- Prevents empty responses

## Test Results After Fixes

### Improved Areas:
- Pricing questions: Now consistently returns "50만원"
- Application/contact: Returns email properly
- Context awareness: Better handling of short questions

### Still Needs Work:
- Network timeouts on some requests
- Confirmation questions need stronger "네" enforcement
- Compound questions need better parsing

## Key Information to Maintain

### Core Facts (Never change):
- 세미나: 총 13회 (NOT 25)
- 논문: 총 25편 (NOT 13)
- 가격: 시간당 50만원
- 시간: 1-2시간 (평균 1시간 30분)
- 연락: chaos@sayberrygames.com
- 학력: KAIST 학사, 석사, 박사

### Date Formatting:
- 고려대: "7월" (no year)
- 경상국립대: "8월 25일" (25 is date, not count!)
- Never add "2025년" to dates

## Development Principle
**NO HARDCODING** - All responses must be generated by AI through prompt engineering, not deterministic code (except for counts which need accuracy).